{% extends "base.html" %}
{% block content %}
<div class="max-w-6xl mx-auto px-6 py-10">
    <h1 class="text-3xl font-bold mb-8 flex items-center gap-3">
        <i data-lucide="user-x" class="w-6 h-6 text-red-400"></i>
        Usuarios inactivos (+60 días sin ingresar)
    </h1>

    <div class="overflow-x-auto rounded-xl shadow-lg border border-gray-700">
        <table class="min-w-full bg-gray-800">
            <thead class="bg-gray-700 text-sm text-gray-300 uppercase">
                <tr>
                    <th class="p-3 text-left">Legajo</th>
                    <th class="p-3 text-left">Nombre</th>
                    <th class="p-3 text-left">Género</th>
                    <th class="p-3 text-left">Fecha Nac.</th>
                    <th class="p-3 text-left">Teléfono</th>
                    <th class="p-3 text-left">Último ingreso</th>
                    <th class="p-3 text-left">Membresía</th>
                    <th class="p-3 text-center">Acciones</th>
                </tr>
            </thead>
            <tbody class="divide-y divide-gray-700 text-sm">
                {% for u in usuarios %}
                <tr class="hover:bg-gray-700">
                    <td class="p-3">{{ u.employeeNo }}</td>
                    <td class="p-3">{{ u.name }}</td>
                    <td class="p-3">{{ u.genero or "-" }}</td>
                    <td class="p-3">{{ u.fecha_nacimiento }}</td>
                    <td class="p-3">{{ u.telefono }}</td>
                    <td class="p-3">{{ u.ultima_fecha }}</td>
                    <td class="p-3">
                        {% if u.membresia == "Vigente" %}
                            <span class="text-green-400 font-semibold">Vigente</span>
                        {% else %}
                            <span class="text-red-500 font-semibold">Vencido</span>
                        {% endif %}
                    </td>
                    <td class="p-3 text-center space-y-1">
                        <button onclick="eliminarUsuario('{{ u.employeeNo }}')" 
                                class="bg-red-600 hover:bg-red-700 px-3 py-1 rounded flex items-center gap-1 justify-center w-full">
                            <i data-lucide="trash-2" class="w-4 h-4"></i> Eliminar
                        </button>
                    </td>
                </tr>
                {% else %}
                <tr><td colspan="8" class="p-4 text-center text-gray-400">No hay usuarios inactivos</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<script>
function eliminarUsuario(legajo) {
    if (confirm(`¿Eliminar al usuario con legajo ${legajo}?`)) {
        fetch(`/eliminar_usuario/${legajo}`, { method: "POST" })
            .then(r => r.json())
            .then(data => {
                if (data.status === 200) location.reload();
                else alert("Error: " + data.response);
            })
            .catch(() => alert("Error al eliminar"));
    }
}
if (window.lucide) lucide.createIcons();
</script>
{% endblock %}
