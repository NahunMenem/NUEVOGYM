{% extends "base.html" %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<h1 class="text-3xl font-bold mb-6 flex items-center gap-2">
  <i data-lucide="bar-chart-2" class="w-6 h-6 text-green-400"></i>
  Dashboard
</h1>

<!-- Filtro -->
<form method="get" class="mb-8 flex flex-col md:flex-row gap-4 bg-gray-800 p-4 rounded-lg">
  <div class="flex-1">
    <label class="block text-sm text-gray-300">Desde</label>
    <input type="date" name="desde" value="{{ desde or '' }}" class="w-full px-4 py-2 rounded bg-gray-900 border border-gray-600 text-white">
  </div>
  <div class="flex-1">
    <label class="block text-sm text-gray-300">Hasta</label>
    <input type="date" name="hasta" value="{{ hasta or '' }}" class="w-full px-4 py-2 rounded bg-gray-900 border border-gray-600 text-white">
  </div>
  <div class="flex items-end">
    <button type="submit" class="bg-green-600 hover:bg-green-700 px-6 py-2 rounded text-white">Filtrar</button>
  </div>
</form>

<!-- KPIs Usuarios -->
<div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-10">
  <div class="bg-gray-800 p-6 rounded-2xl shadow border border-gray-700">
    <div class="flex items-center gap-2 mb-2 text-green-400">
      <i data-lucide="users" class="w-5 h-5"></i>
      <h2 class="text-lg font-semibold">Total Inscriptos</h2>
    </div>
    <p class="text-3xl font-bold text-green-400">{{ total }}</p>
  </div>

  <div class="bg-gray-800 p-6 rounded-2xl shadow border border-gray-700">
    <div class="flex items-center gap-2 mb-2 text-blue-400">
      <i data-lucide="male" class="w-5 h-5"></i>
      <h2 class="text-lg font-semibold">Masculino</h2>
    </div>
    <p class="text-3xl font-bold text-blue-400">{{ hombres }}</p>
  </div>

  <div class="bg-gray-800 p-6 rounded-2xl shadow border border-gray-700">
    <div class="flex items-center gap-2 mb-2 text-pink-400">
      <i data-lucide="female" class="w-5 h-5"></i>
      <h2 class="text-lg font-semibold">Femenino</h2>
    </div>
    <p class="text-3xl font-bold text-pink-400">{{ mujeres }}</p>
  </div>

  <div class="bg-gray-800 p-6 rounded-2xl shadow border border-gray-700">
    <div class="flex items-center gap-2 mb-2 text-gray-400">
      <i data-lucide="help-circle" class="w-5 h-5"></i>
      <h2 class="text-lg font-semibold">Otro/No definido</h2>
    </div>
    <p class="text-3xl font-bold text-gray-400">{{ otros }}</p>
  </div>
</div>

<!-- Ingresos -->
<div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-10">
  <div class="bg-gray-800 p-6 rounded-2xl border border-gray-700">
    <div class="flex items-center gap-2 mb-4 text-green-400">
      <i data-lucide="dollar-sign" class="w-5 h-5"></i>
      <h2 class="text-lg font-semibold">Ingresos Totales</h2>
    </div>
    <p class="text-4xl font-bold text-green-400">${{ '%.2f' | format(total_ingresos) }}</p>
  </div>

  <!-- Ingresos por Método de Pago -->
  <div class="bg-gray-800 p-6 rounded-2xl border border-gray-700">
    <div class="flex items-center gap-2 mb-4 text-green-400">
      <i data-lucide="credit-card" class="w-5 h-5"></i>
      <h2 class="text-lg font-semibold">Ingresos por Método de Pago</h2>
    </div>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      {% for metodo, total in ingresos_por_metodo %}
      <div class="bg-gray-900 p-4 rounded-xl border border-gray-700 shadow">
        <div class="text-sm text-gray-400 mb-1 flex items-center gap-1">
          <i data-lucide="chevron-right" class="w-4 h-4"></i> {{ metodo }}
        </div>
        <p class="text-2xl font-bold text-green-400">${{ '%.2f'|format(total) }}</p>
      </div>
      {% else %}
      <p class="text-gray-400 col-span-full">Sin datos</p>
      {% endfor %}
    </div>
  </div>
</div>



<!-- Clientes destacados -->
<div class="bg-gray-800 p-6 rounded-2xl border border-gray-700">
  <div class="flex items-center gap-2 mb-4 text-green-400">
    <i data-lucide="star" class="w-5 h-5"></i>
    <h2 class="text-lg font-semibold">Clientes con más pagos</h2>
  </div>
  <ul class="divide-y divide-gray-700">
    {% for nombre, total in ingresos_por_cliente %}
    <li class="py-2 flex justify-between">
      <span>{{ nombre }}</span>
      <span class="text-green-300 font-semibold">${{ '%.2f'|format(total) }}</span>
    </li>
    {% else %}
    <li class="py-2 text-gray-400">Sin datos</li>
    {% endfor %}
  </ul>
</div>

<script>
  lucide.createIcons();
</script>
{% endblock %}
